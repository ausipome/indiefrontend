{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"C:/Users/User/Documents/indieBubba/frontend/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/User/Documents/indieBubba/frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:/Users/User/Documents/indieBubba/frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"C:/Users/User/Documents/indieBubba/frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\User\\\\Documents\\\\indieBubba\\\\frontend\\\\components\\\\SignIn.js\",\n    _s = $RefreshSig$();\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  mutation SIGNIN_MUTATION($email: String!, $password: String!) {\\n    authenticateUserWithPassword(email: $email, password: $password) {\\n      ... on UserAuthenticationWithPasswordSuccess {\\n        item {\\n          id\\n          email\\n          name\\n          confirmed\\n        }\\n      }\\n      ... on UserAuthenticationWithPasswordFailure {\\n        message\\n      }\\n    }\\n  }\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  mutation {\\n    endSession\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport gql from 'graphql-tag';\nimport { ApolloConsumer, useMutation } from '@apollo/client';\nimport { useState } from 'react';\nimport Form from './styles/Form';\nimport useForm from '../lib/useForm';\nimport { CURRENT_USER_QUERY, useUser } from './User';\nimport Error from './ErrorMessage';\nvar SIGN_OUT_MUTATION_NEXT = gql(_templateObject());\nvar SIGNIN_MUTATION = gql(_templateObject2());\nexport default function SignIn() {\n  _s();\n\n  var _useState = useState(false),\n      signState = _useState[0],\n      setSignState = _useState[1];\n\n  var user = useUser();\n\n  var _useMutation = useMutation(SIGN_OUT_MUTATION_NEXT, {\n    refetchQueries: [{\n      query: CURRENT_USER_QUERY\n    }]\n  }),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      signout = _useMutation2[0];\n\n  var _useForm = useForm({\n    email: '',\n    password: ''\n  }),\n      inputs = _useForm.inputs,\n      handleChange = _useForm.handleChange,\n      resetForm = _useForm.resetForm;\n\n  var _useMutation3 = useMutation(SIGNIN_MUTATION, {\n    variables: inputs,\n    onCompleted: function onCompleted(data) {\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _data$authenticateUse, _data$authenticateUse2;\n\n        var emailCheck;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                emailCheck = data === null || data === void 0 ? void 0 : (_data$authenticateUse = data.authenticateUserWithPassword) === null || _data$authenticateUse === void 0 ? void 0 : (_data$authenticateUse2 = _data$authenticateUse.item) === null || _data$authenticateUse2 === void 0 ? void 0 : _data$authenticateUse2.confirmed;\n\n                if (emailCheck === 'no') {\n                  signout();\n                  document.getElementById('logMessage').innerHTML = 'Please confirm your email address to continue to use all of Indie Bubbaâ€™s features! ';\n                }\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }))();\n    }\n  }),\n      _useMutation4 = _slicedToArray(_useMutation3, 2),\n      signin = _useMutation4[0],\n      _useMutation4$ = _useMutation4[1],\n      data = _useMutation4$.data,\n      loading = _useMutation4$.loading;\n\n  var error = (data === null || data === void 0 ? void 0 : data.authenticateUserWithPassword.__typename) === 'UserAuthenticationWithPasswordFailure' ? data === null || data === void 0 ? void 0 : data.authenticateUserWithPassword : undefined;\n\n  function handleSubmit(_x) {\n    return _handleSubmit.apply(this, arguments);\n  }\n\n  function _handleSubmit() {\n    _handleSubmit = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e) {\n      var _res$data, _res$data$authenticat, _res$data$authenticat2;\n\n      var res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              document.getElementById('logMessage').innerHTML = '';\n              e.preventDefault(); // stop the form from submitting\n\n              _context2.next = 4;\n              return signin();\n\n            case 4:\n              res = _context2.sent;\n\n              if (((_res$data = res.data) === null || _res$data === void 0 ? void 0 : (_res$data$authenticat = _res$data.authenticateUserWithPassword) === null || _res$data$authenticat === void 0 ? void 0 : (_res$data$authenticat2 = _res$data$authenticat.item) === null || _res$data$authenticat2 === void 0 ? void 0 : _res$data$authenticat2.confirmed) === 'yes') {\n                setSignState(true);\n              }\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return _handleSubmit.apply(this, arguments);\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [signState && /*#__PURE__*/_jsxDEV(ApolloConsumer, {\n      children: function children(client) {\n        client.refetchQueries({\n          include: [CURRENT_USER_QUERY]\n        });\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Form, {\n      method: \"POST\",\n      onSubmit: handleSubmit,\n      children: [user && /*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          color: 'red',\n          textAlign: 'center',\n          fontWeight: 'normal'\n        },\n        children: [\"Welcome back \", user.name, \" \\uD83D\\uDE0A\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Login to Your Account\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          color: 'red',\n          textAlign: 'center',\n          fontWeight: 'normal'\n        },\n        id: \"logMessage\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Error, {\n        error: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"fieldset\", {\n        disabled: loading,\n        \"aria-busy\": loading,\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"email\",\n          children: [\"Email\", /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"email\",\n            name: \"email\",\n            placeholder: \"Your Email Address\",\n            autoComplete: \"email\",\n            value: inputs.email,\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"password\",\n          children: [\"Password\", /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            name: \"password\",\n            placeholder: \"Password\",\n            autoComplete: \"off\",\n            value: inputs.password,\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          children: \"Login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(SignIn, \"HP8i+VBUEd7sR5FMwAPnGq0Bibs=\", false, function () {\n  return [useUser, useMutation, useForm, useMutation];\n});\n\n_c = SignIn;\n\nvar _c;\n\n$RefreshReg$(_c, \"SignIn\");","map":{"version":3,"sources":["C:/Users/User/Documents/indieBubba/frontend/components/SignIn.js"],"names":["gql","ApolloConsumer","useMutation","useState","Form","useForm","CURRENT_USER_QUERY","useUser","Error","SIGN_OUT_MUTATION_NEXT","SIGNIN_MUTATION","SignIn","signState","setSignState","user","refetchQueries","query","signout","email","password","inputs","handleChange","resetForm","variables","onCompleted","data","emailCheck","authenticateUserWithPassword","item","confirmed","document","getElementById","innerHTML","signin","loading","error","__typename","undefined","handleSubmit","e","preventDefault","res","client","include","color","textAlign","fontWeight","name"],"mappings":"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","sourcesContent":["import gql from 'graphql-tag';\r\nimport { ApolloConsumer, useMutation } from '@apollo/client';\r\nimport { useState } from 'react';\r\nimport Form from './styles/Form';\r\nimport useForm from '../lib/useForm';\r\nimport { CURRENT_USER_QUERY, useUser } from './User';\r\nimport Error from './ErrorMessage';\r\n\r\nconst SIGN_OUT_MUTATION_NEXT = gql`\r\n  mutation {\r\n    endSession\r\n  }\r\n`;\r\n\r\nconst SIGNIN_MUTATION = gql`\r\n  mutation SIGNIN_MUTATION($email: String!, $password: String!) {\r\n    authenticateUserWithPassword(email: $email, password: $password) {\r\n      ... on UserAuthenticationWithPasswordSuccess {\r\n        item {\r\n          id\r\n          email\r\n          name\r\n          confirmed\r\n        }\r\n      }\r\n      ... on UserAuthenticationWithPasswordFailure {\r\n        message\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nexport default function SignIn() {\r\n  const [signState, setSignState] = useState(false);\r\n  const user = useUser();\r\n\r\n  const [signout] = useMutation(SIGN_OUT_MUTATION_NEXT, {\r\n    refetchQueries: [{ query: CURRENT_USER_QUERY }],\r\n  });\r\n\r\n  const { inputs, handleChange, resetForm } = useForm({\r\n    email: '',\r\n    password: '',\r\n  });\r\n  const [signin, { data, loading }] = useMutation(SIGNIN_MUTATION, {\r\n    variables: inputs,\r\n    async onCompleted(data) {\r\n      const emailCheck = data?.authenticateUserWithPassword?.item?.confirmed;\r\n      if (emailCheck === 'no') {\r\n        signout();\r\n        document.getElementById('logMessage').innerHTML =\r\n          'Please confirm your email address to continue to use all of Indie Bubbaâ€™s features! ';\r\n      }\r\n    },\r\n  });\r\n  const error =\r\n    data?.authenticateUserWithPassword.__typename ===\r\n    'UserAuthenticationWithPasswordFailure'\r\n      ? data?.authenticateUserWithPassword\r\n      : undefined;\r\n\r\n  async function handleSubmit(e) {\r\n    document.getElementById('logMessage').innerHTML = '';\r\n    e.preventDefault(); // stop the form from submitting\r\n    const res = await signin();\r\n    if (res.data?.authenticateUserWithPassword?.item?.confirmed === 'yes') {\r\n      setSignState(true);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {signState && (\r\n        <ApolloConsumer>\r\n          {(client) => {\r\n            client.refetchQueries({\r\n              include: [CURRENT_USER_QUERY],\r\n            });\r\n          }}\r\n        </ApolloConsumer>\r\n      )}\r\n      <Form method=\"POST\" onSubmit={handleSubmit}>\r\n        {user && (\r\n          <h2\r\n            style={{ color: 'red', textAlign: 'center', fontWeight: 'normal' }}\r\n          >\r\n            Welcome back {user.name} ðŸ˜Š\r\n          </h2>\r\n        )}\r\n        <h2>Login to Your Account</h2>\r\n        <h2\r\n          style={{ color: 'red', textAlign: 'center', fontWeight: 'normal' }}\r\n          id=\"logMessage\"\r\n        />\r\n        <Error error={error} />\r\n        <fieldset disabled={loading} aria-busy={loading}>\r\n          <label htmlFor=\"email\">\r\n            Email\r\n            <input\r\n              type=\"email\"\r\n              name=\"email\"\r\n              placeholder=\"Your Email Address\"\r\n              autoComplete=\"email\"\r\n              value={inputs.email}\r\n              onChange={handleChange}\r\n            />\r\n          </label>\r\n          <label htmlFor=\"password\">\r\n            Password\r\n            <input\r\n              type=\"password\"\r\n              name=\"password\"\r\n              placeholder=\"Password\"\r\n              autoComplete=\"off\"\r\n              value={inputs.password}\r\n              onChange={handleChange}\r\n            />\r\n          </label>\r\n          <button type=\"submit\">Login</button>\r\n        </fieldset>\r\n      </Form>\r\n    </>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}