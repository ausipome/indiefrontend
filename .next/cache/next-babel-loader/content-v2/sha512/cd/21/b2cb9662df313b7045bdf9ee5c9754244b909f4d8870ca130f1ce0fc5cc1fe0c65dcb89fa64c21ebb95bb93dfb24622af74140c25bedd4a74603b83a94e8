{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\User\\\\Documents\\\\indieBubba\\\\frontend\\\\pages\\\\orders.js\";\nimport { useQuery } from '@apollo/client';\nimport gql from 'graphql-tag';\nimport Image from 'next/image';\nimport Head from 'next/head';\nimport styled from 'styled-components';\nimport Link from 'next/link';\nimport ErrorMessage from '../components/ErrorMessage';\nimport formatMoney from '../lib/money';\nimport OrderItemStyles from '../components/styles/OrderItemStyles';\nimport PleaseSignIn from '../components/PleaseSignIn';\nimport { useUser } from '../components/User';\nimport LoadBar from '../components/LoadBar';\nimport Footer from '../components/Footer';\nexport const USER_ORDERS_QUERY = gql`\n  query USER_ORDERS_QUERY($thisUserId: ID) {\n    orders(\n      where: { user: { id: { equals: $thisUserId } } }\n      orderBy: [{ timeStamp: desc }]\n    ) {\n      id\n      charge\n      total\n      user {\n        id\n      }\n      items {\n        id\n        name\n        description\n        price\n        quantity\n        photo {\n          image {\n            publicUrlTransformed\n          }\n        }\n      }\n    }\n  }\n`;\nconst OrderUl = styled.ul.withConfig({\n  displayName: \"orders__OrderUl\",\n  componentId: \"sc-1a9d35r-0\"\n})([\"display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));grid-gap:4rem;\"]);\n\nfunction countItemsInAnOrder(order) {\n  return order.items.reduce((tally, item) => tally + item.quantity, 0);\n}\n\nexport default function OrdersPage() {\n  const theUser = useUser();\n  const postcode = theUser === null || theUser === void 0 ? void 0 : theUser.postcode;\n  const theId = theUser === null || theUser === void 0 ? void 0 : theUser.id;\n  const {\n    data,\n    error,\n    loading\n  } = useQuery(USER_ORDERS_QUERY, {\n    variables: {\n      thisUserId: theId\n    }\n  });\n  if (loading) return /*#__PURE__*/_jsxDEV(LoadBar, {\n    load: loading\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 62,\n    columnNumber: 23\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(ErrorMessage, {\n    error: error\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 21\n  }, this);\n  const {\n    orders\n  } = data;\n  return /*#__PURE__*/_jsxDEV(PleaseSignIn, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Head, {\n        children: /*#__PURE__*/_jsxDEV(\"title\", {\n          children: [\"Your Orders (\", orders.length, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), orders.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            textAlign: 'center'\n          },\n          children: [\"You have placed \", orders.length, \" orders!\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          style: {\n            fontWeight: 'normal'\n          },\n          children: [\"Check out our\", ' ', /*#__PURE__*/_jsxDEV(Link, {\n            href: \"products\",\n            children: /*#__PURE__*/_jsxDEV(\"a\", {\n              style: {\n                color: 'pink',\n                textDecoration: 'underline'\n              },\n              children: \"marketplace\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 15\n          }, this), ' ', \"to start buying!\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Image, {\n          src: \"/baby.jpg\",\n          alt: \"Indie Bubba Crying Baby\",\n          width: \"508px\",\n          height: \"704px\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [orders.length === 1 && /*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            textAlign: 'center'\n          },\n          children: [\"You have placed \", orders.length, \" order!\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 13\n        }, this), orders.length > 1 && /*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            textAlign: 'center'\n          },\n          children: [\"You have placed \", orders.length, \" orders!\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 13\n        }, this), orders.length > 0 && postcode !== null || postcode !== '' && /*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            color: 'red',\n            fontWeight: 'normal',\n            textAlign: 'center'\n          },\n          children: \"Please ensure your delivery address is up to date in your account!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(OrderUl, {\n          children: orders.map(order => /*#__PURE__*/_jsxDEV(OrderItemStyles, {\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              href: `/order/${order.id}`,\n              children: /*#__PURE__*/_jsxDEV(\"a\", {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"order-meta\",\n                  children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                    children: [countItemsInAnOrder(order), \" Items\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 124,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: [order.items.length, \" Product\", order.items.length === 1 ? '' : 's']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 125,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: formatMoney(order.total)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 129,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 123,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"images\",\n                  children: order.items.map(item => {\n                    var _item$photo, _item$photo$image;\n\n                    return /*#__PURE__*/_jsxDEV(\"img\", {\n                      src: (_item$photo = item.photo) === null || _item$photo === void 0 ? void 0 : (_item$photo$image = _item$photo.image) === null || _item$photo$image === void 0 ? void 0 : _item$photo$image.publicUrlTransformed,\n                      alt: item.name\n                    }, `image-${item.id}`, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 133,\n                      columnNumber: 25\n                    }, this);\n                  })\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 131,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 17\n            }, this)\n          }, order.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this);\n}","map":{"version":3,"sources":["C:/Users/User/Documents/indieBubba/frontend/pages/orders.js"],"names":["useQuery","gql","Image","Head","styled","Link","ErrorMessage","formatMoney","OrderItemStyles","PleaseSignIn","useUser","LoadBar","Footer","USER_ORDERS_QUERY","OrderUl","ul","countItemsInAnOrder","order","items","reduce","tally","item","quantity","OrdersPage","theUser","postcode","theId","id","data","error","loading","variables","thisUserId","orders","length","textAlign","fontWeight","color","textDecoration","map","total","photo","image","publicUrlTransformed","name"],"mappings":"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","sourcesContent":["import { useQuery } from '@apollo/client';\r\nimport gql from 'graphql-tag';\r\nimport Image from 'next/image';\r\nimport Head from 'next/head';\r\nimport styled from 'styled-components';\r\nimport Link from 'next/link';\r\nimport ErrorMessage from '../components/ErrorMessage';\r\nimport formatMoney from '../lib/money';\r\nimport OrderItemStyles from '../components/styles/OrderItemStyles';\r\nimport PleaseSignIn from '../components/PleaseSignIn';\r\nimport { useUser } from '../components/User';\r\nimport LoadBar from '../components/LoadBar';\r\nimport Footer from '../components/Footer';\r\n\r\nexport const USER_ORDERS_QUERY = gql`\r\n  query USER_ORDERS_QUERY($thisUserId: ID) {\r\n    orders(\r\n      where: { user: { id: { equals: $thisUserId } } }\r\n      orderBy: [{ timeStamp: desc }]\r\n    ) {\r\n      id\r\n      charge\r\n      total\r\n      user {\r\n        id\r\n      }\r\n      items {\r\n        id\r\n        name\r\n        description\r\n        price\r\n        quantity\r\n        photo {\r\n          image {\r\n            publicUrlTransformed\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nconst OrderUl = styled.ul`\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));\r\n  grid-gap: 4rem;\r\n`;\r\n\r\nfunction countItemsInAnOrder(order) {\r\n  return order.items.reduce((tally, item) => tally + item.quantity, 0);\r\n}\r\n\r\nexport default function OrdersPage() {\r\n  const theUser = useUser();\r\n  const postcode = theUser?.postcode;\r\n  const theId = theUser?.id;\r\n  const { data, error, loading } = useQuery(USER_ORDERS_QUERY, {\r\n    variables: {\r\n      thisUserId: theId,\r\n    },\r\n  });\r\n  if (loading) return <LoadBar load={loading} />;\r\n  if (error) return <ErrorMessage error={error} />;\r\n  const { orders } = data;\r\n  return (\r\n    <PleaseSignIn>\r\n      <div>\r\n        <Head>\r\n          <title>Your Orders ({orders.length})</title>\r\n        </Head>\r\n\r\n        {orders.length === 0 && (\r\n          <div style={{ textAlign: 'center' }}>\r\n            <h2 style={{ textAlign: 'center' }}>\r\n              You have placed {orders.length} orders!\r\n            </h2>\r\n            <h3 style={{ fontWeight: 'normal' }}>\r\n              Check out our{' '}\r\n              <Link href=\"products\">\r\n                <a style={{ color: 'pink', textDecoration: 'underline' }}>\r\n                  marketplace\r\n                </a>\r\n              </Link>{' '}\r\n              to start buying!\r\n            </h3>\r\n            <Image\r\n              src=\"/baby.jpg\"\r\n              alt=\"Indie Bubba Crying Baby\"\r\n              width=\"508px\"\r\n              height=\"704px\"\r\n            />\r\n          </div>\r\n        )}\r\n        <>\r\n          {orders.length === 1 && (\r\n            <h2 style={{ textAlign: 'center' }}>\r\n              You have placed {orders.length} order!\r\n            </h2>\r\n          )}\r\n          {orders.length > 1 && (\r\n            <h2 style={{ textAlign: 'center' }}>\r\n              You have placed {orders.length} orders!\r\n            </h2>\r\n          )}\r\n          {(orders.length > 0 && postcode !== null) ||\r\n            (postcode !== '' && (\r\n              <h2\r\n                style={{\r\n                  color: 'red',\r\n                  fontWeight: 'normal',\r\n                  textAlign: 'center',\r\n                }}\r\n              >\r\n                Please ensure your delivery address is up to date in your\r\n                account!\r\n              </h2>\r\n            ))}\r\n          <OrderUl>\r\n            {orders.map((order) => (\r\n              <OrderItemStyles key={order.id}>\r\n                <Link href={`/order/${order.id}`}>\r\n                  <a>\r\n                    <div className=\"order-meta\">\r\n                      <p>{countItemsInAnOrder(order)} Items</p>\r\n                      <p>\r\n                        {order.items.length} Product\r\n                        {order.items.length === 1 ? '' : 's'}\r\n                      </p>\r\n                      <p>{formatMoney(order.total)}</p>\r\n                    </div>\r\n                    <div className=\"images\">\r\n                      {order.items.map((item) => (\r\n                        <img\r\n                          key={`image-${item.id}`}\r\n                          src={item.photo?.image?.publicUrlTransformed}\r\n                          alt={item.name}\r\n                        />\r\n                      ))}\r\n                    </div>\r\n                  </a>\r\n                </Link>\r\n              </OrderItemStyles>\r\n            ))}\r\n          </OrderUl>\r\n        </>\r\n      </div>\r\n      <Footer />\r\n    </PleaseSignIn>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}